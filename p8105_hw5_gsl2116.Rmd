---
title: "P8105 Homework 5"
author: "Grace Liu"
date: "11/8/2018"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(dplyr)
library(purrr)
```

## Problem 1 
```{r participant data, include=FALSE}
dataframe = 
  list.files("./data", pattern = "*.csv", full.names = TRUE) %>% 
  map(read_csv)

for (i in 1:20) {
  if (i <11) {
   dataframe[[i]] = dataframe[[i]] %>% 
     mutate(arm = "Control", study_id = i)
   }
  if (i >10) {
    dataframe[[i]] = dataframe[[i]] %>% 
      mutate(arm = "Experimental", study_id = i-10)
    }
}

participant_data =
  dataframe %>% 
  reduce(rbind) %>% 
  gather(key = week, value = observation, week_1:week_8) %>% 
  separate(week, into = c("remove", "week"), sep = "_") %>% 
  mutate(week = as.numeric(week), study_id = as.character(study_id)) %>% 
  janitor::clean_names() %>% 
  select(arm, study_id, week, observation)
```

```{r study line graph, fig.align='center'}
participant_data %>% 
  group_by(arm, study_id) %>% 
  ggplot(aes(x = week, y = observation, type = study_id, color = arm)) + 
    geom_line() +
  theme_minimal() +
    theme(legend.position = "bottom") +
    labs(x = "Week", y = "Observations", 
         title = "Observations for each subject, by week and study arm")
```

The figure above details the observations of 20 study participants over eight weeks. Half the participants were assigned to the control arm, and the other half were assigned to the experimental arm. Early in the study, there was not much difference between the two study arms. However, as the weeks passed, the observations for all individuals in the experimental arm increased, even as no appreciable change was seen in participants in the control arm.  

## Problem 2
```{r}
homicides = 
  read_csv("https://raw.githubusercontent.com/washingtonpost/data-homicides/master/homicide-data.csv") %>% 
  mutate(city_state = paste(city, state, sep = ", ")) %>% 
  janitor::clean_names()
```

